#!/bin/bash
DIR_DOTFILES=$HOME/.dotfiles/

savefiles()
{
    # ~/.bin (files only)
    rsync --progress --human-readable --update --checksum \
        $HOME/.bin/* \
        "$DIR_DOTFILES".bin/

    # Files in the home folder
    rsync --progress --human-readable --update --checksum \
        $HOME/{.Xresources,.xinitrc,.bash_profile} \
        "$DIR_DOTFILES"

    # Files in the config folder
    rsync -r --progress --human-readable --update --checksum \
        $HOME/.config/{bspwm,sxhkd,compton,wallpaper.jpg} \
        "$DIR_DOTFILES".config/

    # Fonts files
    rsync --progress --human-readable --update --checksum \
        $HOME/.fonts/* \
        "$DIR_DOTFILES".fonts/
}

restorefiles()
{
    # ~/.bin (files only)
    rsync --progress --human-readable --update --checksum \
        "$DIR_DOTFILES".bin/* \
        $HOME/.bin/

    # Files in the home folder
    rsync --progress --human-readable --update --checksum \
        "$DIR_DOTFILES"/{.Xresources,.xinitrc,.bash_profile} \
        $HOME/

    # Files in the config folder
    rsync -r --progress --human-readable --update --checksum \
        "$DIR_DOTFILES".config/{bspwm,sxhkd,compton,wallpaper.jpg} \
        $HOME/.config/

    # Fonts files
    rsync --progress --human-readable --update --checksum \
        "$DIR_DOTFILES".fonts/* \
        $HOME/.fonts/
        
}

gitpush()
{
    if [[ -z "$1" ]]; then
        echo "Usage: dotfilesupdate gitpush <comment>"
        exit 1
    fi
    CURDIR=$(pwd)
    cd $DIR_DOTFILES
    git add .
    git commit -m "$1"
    git push
    cd $CURDIR
}

gitpull()
{
    CURDIR=$(pwd)
    cd $DIR_DOTFILES
    git pull
    cd $CURDIR
}

case $1 in
    "save") savefiles ;;
    "restore") restorefiles ;;
    "push" ) gitpush $2 ;;
    "pull" ) gitpull ;;
    *)
        echo "Usage: $1 <save|restore>"
        exit 1
        ;;
esac
